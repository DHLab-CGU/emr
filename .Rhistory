icd9S[!is.na(icd9S$Decimal)]
icd9S[!is.na(Decimal),]
icd9S[!is.na(Decimal),-"Decimal"]
icd9S[is.na(Decimal),-"Decimal"]
icd10S <- merge(icd_Short[Date >= icd10usingDate], prICD10, by =  "ICD", all.x = T)
icd10S
icd9D
allWrongICD
allWrongICD <- NA
allWrongICD
nrow(allWrongICD)
!is.na(allWrongICD)
S_WrongFormat
icd9SNA
icd9SWrongFormat
icd9SWrongFormat
icd9SNA
icd10SNA
icd10SWrongFormat
icd10SWrongVer
nrow(icd10SWrongVer)>0
S_WrongVer <- rbind(icd9SNA[!is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"],icd10S[!is.na(Decimal),-"Decimal"])
icd10S[!is.na(Decimal),-"Decimal"]
icd10S
icd_Short <- PrDataFile[!icd_Decimal, on = "Number"]
icd9S <- merge(icd_Short[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Short", all.x = T)
icd_Short <- PrDataFile[!icd_Decimal, on = "Number"]
#' Convert ICD-9-PCS Codes From Decimal To Short Forms
#'
#' Return codes with short forms
#'
#' @import data.table
#' @param icdList only ICD-9-PCS codes have decimal and short forms
#' @source \url{https://www.findacode.com/search/search.php}
#' @source \url{https://www.cms.gov/Medicare/Quality-Initiatives-Patient-Assessment-Instruments/HospitalQualityInits/Downloads/HospitalAppendix_F.pdf}
#' @source \url{https://www.cms.gov/Medicare/Coding/ICD10/2019-ICD-10-PCS.html}
#'
PrDataFile <- samplePrFile[,c(2,3)]
icd10usingDate <- "2015/10/01"
names(PrDataFile) <- c("ICD", "Date")
PrDataFile[,"Date"] <- as.Date(PrDataFile[,Date])
PrDataFile[,Number:=1:nrow(PrDataFile)]
icd_Decimal <- PrDataFile[grepl("[.]",PrDataFile$ICD),]
icd9D <- merge(icd_Decimal[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Decimal", all.x = T)
icd9DWrongFormat <- icd9D[is.na(Short), list(count = .N),by = ICD]
icd9DWrongFormat
D_WrongFormat
D_WrongFormat <- icd9D[is.na(Short),-"Short"]
D_WrongFormat
icd9DWrongFormat
if(anyNA(icd9D[,Short])|nrow(icd_Decimal)>nrow(icd9D)){
icd9DWrongFormat <- icd9D[is.na(Short), list(count = .N),by = ICD]
D_WrongFormat <- icd9D[is.na(Short),-"Short"]
icd10D <- icd_Decimal[Date >= icd10usingDate]
if(nrow(icd_Decimal)>nrow(icd9D) & anyNA(icd9D[,Short])){
D_WrongICD <- rbind(D_WrongFormat,icd10D)
}else if(anyNA(icd9D[,Short]) & !nrow(icd_Decimal)>nrow(icd9D)){
D_WrongICD <- D_WrongFormat
}else if(!anyNA(icd9D[,Short]) & nrow(icd_Decimal)>nrow(icd9D)){
D_WrongICD <- icd10D
}
}else{
D_WrongICD <- NA
}
D_WrongICD
icd9DWrongFormat
icd_Short <- PrDataFile[!icd_Decimal, on = "Number"]
icd9S <- merge(icd_Short[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Short", all.x = T)
icd10S <- merge(icd_Short[Date >= icd10usingDate], prICD10, by =  "ICD", all.x = T)
icd_Short
icd9S
icd10S
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd9SNA
anyNA(icd9S[,Decimal])
icd9S
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd9SNA
icd9S[is.na(Decimal),-"Decimal"]
icd9SNA
is.na(icd9SNA[,ICD_DESCRIPTION])
anyNA(icd9SNA[,ICD_DESCRIPTION])
is.na(icd9SNA[,ICD_DESCRIPTION])
icd9SNA[is.na(ICD_DESCRIPTION)]
sum(is.na(icd9S[,Decimal]))
sum(is.na(icd9SNA[,ICD_DESCRIPTION]))
anyNA(icd9SNA[,ICD_DESCRIPTION])
icd10S
anyNA(icd10[,ICD_DESCRIPTION])
anyNA(icd10S[,ICD_DESCRIPTION])
icd9S <- merge(icd_Short[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Short", all.x = T)
icd10S <- merge(icd_Short[Date >= icd10usingDate], prICD10, by =  "ICD", all.x = T)
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd10SNA <- merge(icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"],ICD9DxwithTwoFormat,by.x = "ICD",by.y = "Short",all.x = T)
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
icd9SWrongVer <- icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
icd10SWrongFormat <- icd10SNA[is.na(icd10SNA[,Decimal]), list(count = .N),by = ICD]
icd10SWrongVer <- icd10SNA[!is.na(icd10SNA[,Decimal]), list(count = .N),by = ICD]
icd9SWrongFormat
icd9SWrongVer
icd10SWrongFormat
icd10SWrongVer
anyNA(icd9SWrongFormat)
wrongformatMsg_S<- rbind(icd9SWrongFormat,icd10SWrongFormat)
wrongformatMsg_S
WrongFormat_S <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
WrongFormat_S
icd10SNA[is.na(icd10SNA[,Decimal])][,list(count = .N),by = ICD]
icd9S[,Decimal]
icd9S[is.na(Decimal),]
StoSNA <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
StoSNA
StoSNA <- rbind(icd9S[is.na(ICD),-"Decimal"],icd10S[is.na(ICD),-"ICD_DESCRIPTION"])
StoSNA
nrow(StoSNA)>0
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd10SNA <- merge(icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"],ICD9DxwithTwoFormat,by.x = "ICD",by.y = "Short",all.x = T)
StoSNA <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
icd9SNA
icd10SNA
icd9SWrongFormat
icd10SWrongFormat
anyNA(icd9SWrongFormat)
nrow(icd9SWrongFormat)
!anyNA(icd9SWrongFormat)
icd9SWrongFormat <- 0
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD]), list(count = .N),by = ICD]
icd9SWrongFormat
nrow(icd9SWrongFormat)>0
anyNA(icd9SWrongFormat)
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
nrow(icd9SWrongFormat)>0
anyNA(icd9SWrongFormat)
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
nrow(icd9SWrongFormat)>0
icd10SWrongFormat <- icd10SNA[is.na(icd10SNA[,Decimal]), list(count = .N),by = ICD]
icd10SWrongFormat
nrow(icd9SWrongFormat)>0 & nrow(icd10SWrongFormat)>0
wrongformatMsg_S<- rbind(icd9SWrongFormat,icd10SWrongFormat)
WrongFormat_S <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
wrongformatMsg_S
WrongFormat_S
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
wrongformatMsg_S
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
wrongformatMsg_S
if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
wrongformatMsg_S
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}
wrongformatMsg_S
WrongFormat_S
if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
wrongformatMsg_S
WrongFormat_S
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD]), list(count = .N),by = ICD]
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}
wrongformatMsg_S
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD]), list(count = .N),by = ICD]
icd9SWrongFormat
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}
wrongformatMsg_S
icd9SWrongFormat
icd10SWrongFormat <- icd10SNA[is.na(icd10SNA[,Decimal]), list(count = .N),by = ICD]
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
if(nrow(icd10SWrongFormat)>0 & nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
wrongformatMsg_S
WrongFormat_S
wrongformatMsg_S
icd10SWrongFormat
icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
icd10SWrongFormat <- icd10SNA[is.na(icd10SNA[,ICD]), list(count = .N),by = ICD]
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
if(nrow(icd10SWrongFormat)>0 & nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
icd9SWrongFormat
icd10SWrongFormat
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
wrongformatMsg_S
if(nrow(icd10SWrongFormat)>0 & nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}else{
wrongformatMsg_S<-NA
WrongFormat_S <- NA
}
wrongformatMsg_S
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
if(nrow(icd10SWrongFormat)>0 & nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}else{
wrongformatMsg_S<-NA
WrongFormat_S <- NA
}
icd9SWrongFormat <- icd9SNA[is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
icd10SWrongFormat <- icd10SNA[is.na(icd10SNA[,Decimal]), list(count = .N),by = ICD]
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
wrongformatMsg_S
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
if(nrow(icd10SWrongFormat)>0 & nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}else{
wrongformatMsg_S<-NA
WrongFormat_S <- NA
}
wrongformatMsg_S
icd9SWrongVer <- icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
icd10SWrongVer <- icd10SNA[!is.na(icd10SNA[,Decimal]), list(count = .N),by = ICD]
icd9SWrongVer
icd10SWrongVer
icd9SNA
icd9SWrongFormat
WrongFormat_S
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
wrongformatMsg_S
WrongFormat_S
icd9S[is.na(Decimal),-"Decimal"]
icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION])]
icd9SNA
View(prICD10)
icd9SNA[3,] <- icd9SNA[2,]
icd9SNA[3] <- icd9SNA[2]
icd9SNA
icd9SNA[3,] <- icd9SNA[2,]
icd9SNA[3,] <- list("0016075")
icd9SNA[3,] <- list("0016075","","",NA)
rbind(list("0016075","","",NA),icd9SNA)
rbind(c("0016075","","",NA),icd9SNA)
rbind(data.table("0016075","","",NA),icd9SNA)
merge(data.table("0016075","","",NA),icd9SNA)
icd9SNA[3]<=c("0016075","","",NA)
icd9SNA[3]<-c("0016075","","",NA)
icd9SNA[2]
rbind(icd9SNA,icd9SNA[2])
icd9SNA
icd9SNA <- rbind(icd9SNA,icd9SNA[2])
icd9SNA[3]<-c("0016075","","",NA)
icd9SNA[3]
icd9SNA
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd9SNA <- rbind(icd9SNA,icd9SNA[2])
icd9SNA
icd9SNA[3][1]#<-"0016075"
icd9SNA[3][[1]]#<-"0016075"
icd9SNA[3][[1]]<-"0016075"
icd9SNA[3]#[[1]]<-"0016075"
icd9SNA[3][[3]]<-"4011"
icd9SNA
icd9S[is.na(Decimal),-"Decimal"]
icd9S <- rbind(icd9S,icd9S[2])
icd9S[3][[1]]<- "0016074"
icd9S
icd9S[is.na(Decimal),-"Decimal"]
icd9S <- merge(icd_Short[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Short", all.x = T)
icd9S[is.na(Decimal),-"Decimal"]
icd9S[is.na(Decimal),]
test <- icd9S[is.na(Decimal),]
test <- rbind(test,test[2])
test[3][[1]] <- "0016074"
test
icd9SNA <- merge(test, prICD10, by = "ICD", all.x = T)
icd9SNA
icd9SNA <- merge(test[,-"Decimal"], prICD10, by = "ICD", all.x = T)
icd9SNA
icd9SWrongVer <- icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION]), list(count = .N),by = ICD]
icd9SWrongVer
nrow(icd9SWrongVer)>0
icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION])]
WrongVersion_S <- icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION]),,-"ICD_DESCRIPTION"]
WrongVersion_S <- icd9SNA[!is.na(icd9SNA[,ICD_DESCRIPTION]),-"ICD_DESCRIPTION"]
WrongVersion_S
icd10S
icd10SNA
icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION)]#,-"ICD_DESCRIPTION"]
WrongFormat_S
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
WrongVersion_S
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION)]#,-"ICD_DESCRIPTION"]
WrongVersion_S
wrongVersionMsg_S
wrongVersionMsg_S<-icd9SWrongVer
wrongVersionMsg_S
icd_Short <- PrDataFile[!icd_Decimal, on = "Number"]
icd9S <- merge(icd_Short[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Short", all.x = T)
icd10S <- merge(icd_Short[Date >= icd10usingDate], prICD10, by =  "ICD", all.x = T)
StoSNA <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
if(nrow(StoSNA)>0){ #StoS wrong
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd10SNA <- merge(icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"],ICD9DxwithTwoFormat,by.x = "ICD",by.y = "Short",all.x = T)
icd9SWrongFormat <- icd9SNA[is.na(ICD_DESCRIPTION), list(count = .N),by = ICD]
icd10SWrongFormat <- icd10SNA[is.na(Decimal), list(count = .N),by = ICD]
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<-icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}
if(nrow(icd10SWrongFormat)>0 & nrow(icd9SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}else{
wrongformatMsg_S<-NA
WrongFormat_S <- NA
}
icd9SWrongVer <- icd9SNA[!is.na(ICD_DESCRIPTION), list(count = .N),by = ICD]
icd10SWrongVer <- icd10SNA[!is.na(Decimal), list(count = .N),by = ICD]
if(nrow(icd9SWrongVer)>0){
wrongVersionMsg_S<-icd9SWrongVer
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION)],-"ICD_DESCRIPTION"]
}else if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- icd10SWrongVer
WrongVersion_S <- icd10SNA[!is.na(Decimal),-"Decimal"]
}
if(nrow(icd9SWrongVer)>0 & nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- rbind(wrongVersionMsg_S,icd10SWrongVer)
WrongVersion_S <- rbind(WrongVersion_S,icd10SNA[is.na(Decimal),-"Decimal"])
}else{
wrongVersionMsg_S<-NA
WrongVersion_S <- NA
}
wrongVersionMsg_S
WrongVersion_S
WrongFormat_S
wrongformatMsg_S
icd9SWrongFormat
icd9S[is.na(Decimal),-"Decimal"]
if(nrow(icd9SWrongVer)>0){
wrongVersionMsg_S<-icd9SWrongVer
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION)],-"ICD_DESCRIPTION"]
if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- rbind(wrongVersionMsg_S,icd10SWrongVer)
WrongVersion_S <- rbind(WrongVersion_S,icd10SNA[is.na(Decimal),-"Decimal"])
}
}else if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- icd10SWrongVer
WrongVersion_S <- icd10SNA[!is.na(Decimal),-"Decimal"]
}else{
wrongVersionMsg_S<-NA
WrongVersion_S <- NA
}
if(nrow(icd9SWrongVer)>0){
wrongVersionMsg_S<-icd9SWrongVer
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION)],-"ICD_DESCRIPTION"]
}else if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- icd10SWrongVer
WrongVersion_S <- icd10SNA[!is.na(Decimal),-"Decimal"]
}else{
wrongVersionMsg_S<-NA
WrongVersion_S <- NA
}
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S <- icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}else{
wrongformatMsg_S<-NA
WrongFormat_S <- NA
}
icd9SWrongVer <- icd9SNA[!is.na(ICD_DESCRIPTION), list(count = .N),by = ICD]
icd10SWrongVer <- icd10SNA[!is.na(Decimal), list(count = .N),by = ICD]
if(nrow(icd9SWrongVer)>0){
wrongVersionMsg_S<-icd9SWrongVer
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION)],-"ICD_DESCRIPTION"]
}
if(nrow(icd9SWrongVer)>0){
wrongVersionMsg_S<-icd9SWrongVer
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- rbind(wrongVersionMsg_S,icd10SWrongVer)
WrongVersion_S <- rbind(WrongVersion_S,icd10SNA[is.na(Decimal),-"Decimal"])
}
}else if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- icd10SWrongVer
WrongVersion_S <- icd10SNA[!is.na(Decimal),-"Decimal"]
}else{
wrongVersionMsg_S<-NA
WrongVersion_S <- NA
}
icd_Short <- PrDataFile[!icd_Decimal, on = "Number"]
icd9S <- merge(icd_Short[Date < icd10usingDate], ICD9PrwithTwoFormat, by.x = "ICD", by.y = "Short", all.x = T)
icd10S <- merge(icd_Short[Date >= icd10usingDate], prICD10, by =  "ICD", all.x = T)
StoSNA <- rbind(icd9S[is.na(Decimal),-"Decimal"],icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
if(nrow(StoSNA)>0){ #StoS wrong
if(nrow(StoSNA)>0){ #StoS wrong
if(nrow(StoSNA)>0){ #StoS wrong
icd9SNA <- merge(icd9S[is.na(Decimal),-"Decimal"], prICD10, by = "ICD", all.x = T)
icd10SNA <- merge(icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"],ICD9DxwithTwoFormat,by.x = "ICD",by.y = "Short",all.x = T)
icd9SWrongFormat <- icd9SNA[is.na(ICD_DESCRIPTION), list(count = .N),by = ICD]
icd10SWrongFormat <- icd10SNA[is.na(Decimal), list(count = .N),by = ICD]
if(nrow(icd9SWrongFormat)>0){
wrongformatMsg_S <- icd9SWrongFormat
WrongFormat_S <- icd9S[is.na(Decimal),-"Decimal"]
if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- rbind(wrongformatMsg_S,icd10SWrongFormat)
WrongFormat_S <- rbind(WrongFormat_S,icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"])
}
}else if(nrow(icd10SWrongFormat)>0){
wrongformatMsg_S<- icd10SWrongFormat
WrongFormat_S <- icd10S[is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
}else{
wrongformatMsg_S<-NA
WrongFormat_S <- NA
}
icd9SWrongVer <- icd9SNA[!is.na(ICD_DESCRIPTION), list(count = .N),by = ICD]
icd10SWrongVer <- icd10SNA[!is.na(Decimal), list(count = .N),by = ICD]
if(nrow(icd9SWrongVer)>0){
wrongVersionMsg_S<-icd9SWrongVer
WrongVersion_S <- icd9SNA[!is.na(ICD_DESCRIPTION),-"ICD_DESCRIPTION"]
if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- rbind(wrongVersionMsg_S,icd10SWrongVer)
WrongVersion_S <- rbind(WrongVersion_S,icd10SNA[is.na(Decimal),-"Decimal"])
}
}else if(nrow(icd10SWrongVer)>0){
wrongVersionMsg_S<- icd10SWrongVer
WrongVersion_S <- icd10SNA[!is.na(Decimal),-"Decimal"]
}else{
wrongVersionMsg_S<-NA
WrongVersion_S <- NA
}
}
icd9SNA
load("~/emr/data/ICD9PrwithTwoFormat.rda")
load("~/emr/data/prICD10.rda")
load("~/emr/data/samplePrFile.rda")
