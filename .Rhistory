substr(grep_icd9_elix$ICD[1], start = 1,stop = 3)
grep(substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),dxICD9$ICD)
dxICD9$ICD[grep(substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),dxICD9$ICD)]
dxICD9$ICD[grep(^substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",substr(grep_icd9_elix$ICD[1],sep=""), start = 1,stop = 3),dxICD9$ICD)]
paste("^",substr(grep_icd9_elix$ICD[1],sep="")
grep(paste("^",substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),sep="")
paste("^",substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),sep="")
dxICD9$ICD[grep(paste("^",substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),sep=""),dxICD9$ICD)]
nchar(grep_icd9_elix$ICD[1])
View(textFile)
textFile$ICD <- gsub('"',"",textFile$ICD)
textFile$ICD <- str_trim(textFile$ICD,"left")
comorbidity_title <- grep("=",textFile$ICD)
name_elix <- data.frame(Elix = unlist(unname(strsplit(textFile[comorbidity_title,],split = "="))),stringsAsFactors = F)
name_elix$Elix[seq(2,nrow(name_elix), 2), ]
name_elix$Elix[seq(2,nrow(name_elix), 2)]
elix_abbr <- substr(name_elix$Elix[seq(2, nrow(name_elix), 2)],start = 1,stop=10)
elix_abbr
elix_abbr <- str_trim(elix_abbr, "both")
elix_abbr
View(name_elix)
name_elix$Elix[seq(2, nrow(name_elix), 2)][1]
for (i in 1:length(elix_abbr)){
elix_full[i] <- sub(elix_abbr[i],"",name_elix$Elix[seq(2, nrow(name_elix), 2)][i])
}
elix_full <- c()
for (i in 1:length(elix_abbr)){
elix_full[i] <- sub(elix_abbr[i],"",name_elix$Elix[seq(2, nrow(name_elix), 2)][i])
}
elix_full
elix_full <- gsub("[/*]|[*/] ","",elix_full)
elix_full
elix_full <- str_trim(elix_full, "both")
elix_full
name_elix$Elix[seq(1, nrow(name_elix), 2)]
name_elix$Elix[seq(2, nrow(name_elix), 1)]
name_elix$Elix[seq(3, nrow(name_elix), 2)]
View(name_elix)
name_elix$Elix[seq(1, nrow(name_elix), 2)]
icd9_elix$ICD <- str_trim(icd9_elix$ICD,"both")
icd9_elix$ICD
icd9elix_TextToDf <- function(textFile){
names(textFile) <- "ICD"
textFile$ICD <- gsub('"',"",textFile$ICD)
textFile$ICD <- str_trim(textFile$ICD,"left")
comorbidity_title <- grep("=",textFile$ICD)
name_elix <- data.frame(Elix = unlist(unname(strsplit(textFile[comorbidity_title,],split = "="))),stringsAsFactors = F)
elix_abbr <- substr(name_elix$Elix[seq(2, nrow(name_elix), 2)],start = 1,stop=10)
elix_abbr <- str_trim(elix_abbr, "both")
elix_full <- c()
for (i in 1:length(elix_abbr)){
elix_full[i] <- sub(elix_abbr[i],"",name_elix$Elix[seq(2, nrow(name_elix), 2)][i])
}
elix_full <- gsub("[/*]|[*/] ","",elix_full)
elix_full <- str_trim(elix_full, "both")
icd9_elix <- data.frame(Comorbidity_abbr =elix_abbr, Comorbidity = elix_full, stringsAsFactors = F)
icd9_elix$ICD <- name_elix$Elix[seq(1, nrow(name_elix), 2)]
icd9_elix$ICD <- str_trim(icd9_elix$ICD,"both")
ICDLlist <- list()
for (ICD in 1:(nrow(icd9_elix)-1)){
if(ICD ==1){
ICDLlist[[length(ICDLlist)+1]] <- textFile$ICD[comorbidity_title[ICD]-1:(comorbidity_title[ICD])]
Df <- data.frame(ICD = ICDLlist[[ICD]],
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[ICD],
Comorbidity = icd9_elix$Comorbidity[ICD],
stringsAsFactors = F)
icd9_elix <- rbind(icd9_elix,Df)
}else{
ICDLlist[[length(ICDLlist)+1]] <- textFile$ICD[(comorbidity_title[ICD-1]+1):comorbidity_title[ICD]]
Df <- data.frame(ICD = ICDLlist[[ICD]],
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[ICD],
Comorbidity = icd9_elix$Comorbidity[ICD],
stringsAsFactors = F)
icd9_elix <- rbind(icd9_elix,Df)
}
}
icd9_elix <- icd9_elix[-grep("=",icd9_elix$ICD),]
icd9_elix$ICD <- gsub(',$| ,$| $',"",icd9_elix$ICD)
ICD <- unlist(unname(strsplit(icd9_elix[grep(",",icd9_elix$ICD),3],split = ",")))
icd9_elix <- rbind(data.frame(Comorbidity_abbr = icd9_elix[grep(",",icd9_elix$ICD),1],
Comorbidity = icd9_elix[grep(",",icd9_elix$ICD),2],
ICD = ICD,
stringsAsFactors = F),icd9_elix)
icd9_elix <- icd9_elix[-grep(",",icd9_elix$ICD),]
grep_icd9_elix <- icd9_elix[grep("-",icd9_elix$ICD),]
icd9_elix$Value <- 1
icd9_elix
}
textFile <- read.delim("~/P-Dx/data/comorbidity/ELIXHAUSER_icd9_2012-2015.txt", stringsAsFactors = F)
icd9_elix <- icd9elix_TextToDf(textFile)
View(textFile)
names(textFile) <- "ICD"
textFile$ICD <- gsub('"',"",textFile$ICD)
textFile$ICD <- str_trim(textFile$ICD,"left")
comorbidity_title <- grep("=",textFile$ICD)
name_elix <- data.frame(Elix = unlist(unname(strsplit(textFile[comorbidity_title,],split = "="))),stringsAsFactors = F)
View(name_elix)
elix_abbr <- substr(name_elix$Elix[seq(2, nrow(name_elix), 2)],start = 1,stop=10)
elix_abbr
elix_abbr <- str_trim(elix_abbr, "both")
elix_abbr
elix_full <- c()
for (i in 1:length(elix_abbr)){
elix_full[i] <- sub(elix_abbr[i],"",name_elix$Elix[seq(2, nrow(name_elix), 2)][i])
}
elix_full
elix_full <- gsub("[/*]|[*/] ","",elix_full)
elix_full
elix_full <- str_trim(elix_full, "both")
elix_full
icd9_elix <- data.frame(Comorbidity_abbr =elix_abbr, Comorbidity = elix_full, stringsAsFactors = F)
icd9_elix$ICD <- name_elix$Elix[seq(1, nrow(name_elix), 2)]
icd9_elix$ICD <- str_trim(icd9_elix$ICD,"both")
ICDLlist <- list()
for (ICD in 1:(nrow(icd9_elix)-1)){
if(ICD ==1){
ICDLlist[[length(ICDLlist)+1]] <- textFile$ICD[comorbidity_title[ICD]-1:(comorbidity_title[ICD])]
Df <- data.frame(ICD = ICDLlist[[ICD]],
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[ICD],
Comorbidity = icd9_elix$Comorbidity[ICD],
stringsAsFactors = F)
icd9_elix <- rbind(icd9_elix,Df)
}else{
ICDLlist[[length(ICDLlist)+1]] <- textFile$ICD[(comorbidity_title[ICD-1]+1):comorbidity_title[ICD]]
Df <- data.frame(ICD = ICDLlist[[ICD]],
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[ICD],
Comorbidity = icd9_elix$Comorbidity[ICD],
stringsAsFactors = F)
icd9_elix <- rbind(icd9_elix,Df)
}
}
icd9_elix
icd9_elix <- icd9_elix[-grep("=",icd9_elix$ICD),]
icd9_elix$ICD <- gsub(',$| ,$| $',"",icd9_elix$ICD)
icd9_elix[grep(",",icd9_elix$ICD),3]
icd9_elix$ICD <- str_trim(icd9_elix$ICD,"both")
icd9_elix$ICD <- gsub(',$| ,$| $',"",icd9_elix$ICD)
icd9_elix[grep(",",icd9_elix$ICD),3]
icd9elix_TextToDf <- function(textFile){
names(textFile) <- "ICD"
textFile$ICD <- gsub('"',"",textFile$ICD)
textFile$ICD <- str_trim(textFile$ICD,"left")
comorbidity_title <- grep("=",textFile$ICD)
name_elix <- data.frame(Elix = unlist(unname(strsplit(textFile[comorbidity_title,],split = "="))),stringsAsFactors = F)
elix_abbr <- substr(name_elix$Elix[seq(2, nrow(name_elix), 2)],start = 1,stop=10)
elix_abbr <- str_trim(elix_abbr, "both")
elix_full <- c()
for (i in 1:length(elix_abbr)){
elix_full[i] <- sub(elix_abbr[i],"",name_elix$Elix[seq(2, nrow(name_elix), 2)][i])
}
elix_full <- gsub("[/*]|[*/] ","",elix_full)
elix_full <- str_trim(elix_full, "both")
icd9_elix <- data.frame(Comorbidity_abbr =elix_abbr, Comorbidity = elix_full, stringsAsFactors = F)
icd9_elix$ICD <- name_elix$Elix[seq(1, nrow(name_elix), 2)]
icd9_elix$ICD <- str_trim(icd9_elix$ICD,"both")
ICDLlist <- list()
for (ICD in 1:(nrow(icd9_elix)-1)){
if(ICD ==1){
ICDLlist[[length(ICDLlist)+1]] <- textFile$ICD[comorbidity_title[ICD]-1:(comorbidity_title[ICD])]
Df <- data.frame(ICD = ICDLlist[[ICD]],
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[ICD],
Comorbidity = icd9_elix$Comorbidity[ICD],
stringsAsFactors = F)
icd9_elix <- rbind(icd9_elix,Df)
}else{
ICDLlist[[length(ICDLlist)+1]] <- textFile$ICD[(comorbidity_title[ICD-1]+1):comorbidity_title[ICD]]
Df <- data.frame(ICD = ICDLlist[[ICD]],
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[ICD],
Comorbidity = icd9_elix$Comorbidity[ICD],
stringsAsFactors = F)
icd9_elix <- rbind(icd9_elix,Df)
}
}
icd9_elix$ICD <- str_trim(icd9_elix$ICD,"both")
icd9_elix <- icd9_elix[-grep("=",icd9_elix$ICD),]
icd9_elix$ICD <- gsub(',$| ,$| $',"",icd9_elix$ICD)
ICD <- unlist(unname(strsplit(icd9_elix[grep(",",icd9_elix$ICD),3],split = ",")))
icd9_elix <- rbind(data.frame(Comorbidity_abbr = icd9_elix[grep(",",icd9_elix$ICD),1],
Comorbidity = icd9_elix[grep(",",icd9_elix$ICD),2],
ICD = ICD,
stringsAsFactors = F),icd9_elix)
icd9_elix <- icd9_elix[-grep(",",icd9_elix$ICD),]
grep_icd9_elix <- icd9_elix[grep("-",icd9_elix$ICD),]
icd9_elix$Value <- 1
icd9_elix
}
textFile <- read.delim("~/P-Dx/data/comorbidity/ELIXHAUSER_icd9_2012-2015.txt", stringsAsFactors = F)
icd9_elix <- icd9elix_TextToDf(textFile)
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-"))),stringsAsFactors = F)
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-"))),stringsAsFactors = F)
grep_icd9_elix
grep_icd9_elix$ICD <- str_trim(grep_icd9_elix$ICD,"both")
grep_icd9_elix$ICD
dxICD9$ICD[grep(paste("^",substr(grep_icd9_elix$ICD[1], start = 1,stop = 3),sep=""),dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",substr(grep_icd9_elix$ICD[2], start = 1,stop = 3),sep=""),dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",substr(grep_icd9_elix$ICD[3], start = 1,stop = 3),sep=""),dxICD9$ICD)]
dxICD9$ICD[grep(grep_icd9_elix$ICD[3],dxICD9$ICD)]
dxICD9$ICD[grep(grep_icd9_elix$ICD[1],dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",grep_icd9_elix$ICD[3],"$"),dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",grep_icd9_elix$ICD[3],"$",sep=""),dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)]
dxICD9$ICD[grep(paste("^",grep_icd9_elix$ICD[2],"$",sep=""),dxICD9$ICD)]
grep(paste("^",grep_icd9_elix$ICD[2],"$",sep=""),dxICD9$ICD)
grep(paste("^",grep_icd9_elix$ICD[2],"$",sep=""),dxICD9$ICD)
for(range in 1:nrow(grep_icd9_elix)){
ICDLlist[range] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
grep_icd9_elix$ICD
}
nrow(grep_icd9_elix)
for(range in 1:nrow(grep_icd9_elix)){
ICDLlist[range] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
ICDLlist[range] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
grep(paste("^",grep_icd9_elix$ICD[2],"$",sep=""),dxICD9$ICD)
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
grep(paste("^",grep_icd9_elix$ICD[3],"$",sep=""),dxICD9$ICD)
grep(paste("^",grep_icd9_elix$ICD[4],"$",sep=""),dxICD9$ICD)
ICDLlist[length(ICDLlist)] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
for(range in 1:nrow(grep_icd9_elix)){
ICDLlist[length(ICDLlist)] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
View(ICDLlist)
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
ICDLlist[length(ICDLlist)] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
length(ICDLlist)
anti_join(grep_icd9_elix,dxICD9,"ICD")
load("~/emr/data/dxICD10.rda")
View(dxICD10)
inner_join(dxICD9,grep_icd9_elix,"ICD")
inner_join <- inner_join(dxICD9,grep_icd9_elix,"ICD")
View(inner_join)
for(range in 1:nrow(inner_join)){
ICDLlist[length(ICDLlist)] <- grep(paste("^",inner_join$ICD[range],"$",sep=""),dxICD9$ICD)
}
ICDLlist
grep_icd9_elix
ICDlist <- c()
inner_join <- inner_join(dxICD9,grep_icd9_elix,"ICD")
for(range in 1:nrow(inner_join)){
ICDLlist[length(ICDLlist)] <- grep(paste("^",inner_join$ICD[range],"$",sep=""),dxICD9$ICD)
}
ICDLlist
ICDlist <- c()
ICDlist <- c()
inner_join <- inner_join(dxICD9,grep_icd9_elix,"ICD")
for(range in 1:nrow(inner_join)){
ICDlist[length(ICDlist)+1] <- grep(paste("^",inner_join$ICD[range],"$",sep=""),dxICD9$ICD)
}
ICDlist
grep("2873",dxICD9$ICD)
grep("^2873$",dxICD9$ICD)
ifelse(grep("^2873$",dxICD9$ICD),grep("^2873$",dxICD9$ICD),"")
ifelse(grepl("^2873$",dxICD9$ICD),grep("^2873$",dxICD9$ICD),"")
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
# ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
ICDlist[length(ICDlist)+1] <- ifelse(grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD),
grep("^2873$",dxICD9$ICD),
"")
}
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
# ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
ICDlist[length(ICDlist)+1] <- ifelse(grepl(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD),
grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD),
"")
}
ICDlist
grep_icd9_elix$ICD
ICDlist <- list()
for(range in 1:nrow(grep_icd9_elix)){
ICD <- ifelse(grepl(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD),
grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD),
"")
ICDlist[[length(ICDlist)+1]]<- ICD
}
ICDlist
View(ICDlist)
ifelse(grepl(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD),
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD),
"")
grepl(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
if(sum(grepl(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD))>=1){
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}
# if(sum(grepl(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD))>=1){
if(sum(grepl(paste("^","2873","$",sep=""),dxICD9$ICD))>=1){
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
if(sum(grepl(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD))>=1){
ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}else{
ICDlist[length(ICDlist)+1] <- ""
}
}
ICDlist
for(range in 1:nrow(grep_icd9_elix)){
if(sum(grepl(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD))>=1){
ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}else{
ICDlist[length(ICDlist)+1] <- ""
}
}
ICDlist
dxICD9$ICD[ICDlist]
grep_icd9_elix
if(sum(grepl(paste("^","4280","$",sep=""),dxICD9$ICD))>=1){
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}else{
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}
if(sum(grepl(paste("^","4280","$",sep=""),dxICD9$ICD))>=1){
grep(paste("^","4280","$",sep=""),dxICD9$ICD)
}else{
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}
if(sum(grepl(paste("^","4289","$",sep=""),dxICD9$ICD))>=1){
grep(paste("^","4289","$",sep=""),dxICD9$ICD)
}else{
grep(paste("^",grep_icd9_elix$ICD[1],"$",sep=""),dxICD9$ICD)
}
dxICD9$ICD[4794]
dxICD9$ICD[4808]
as.integer(ICDlist)
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
if(sum(grepl(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD))>=1){
ICDlist[length(ICDlist)+1] <- as.integer(grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD))
}else{
ICDlist[length(ICDlist)+1] <- ""
}
}
dxICD9$ICD[ICDlist]
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
if(sum(grepl(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD))>=1){
ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}else{
ICDlist[length(ICDlist)+1] <- ""
}
}
dxICD9$ICD[ICDlist]
dxICD9$ICD[ICDlist[1]]
ICDlist
dxICD9$ICD[as.integer(ICDlist)]
ICDlist[2]-ICDlist[1]
ICDlist <- as.integer(ICDlist)
ICDlist[2]-ICDlist[1]
dxICD9$ICD[ICDlist[1]:(ICDlist[1]+(ICDlist[2]-ICDlist[1]))]
test <- grep_icd9_elix
test$Comorbidity_abbr <- icd9_elix$Comorbidity_abbr[grep(grep_icd9_elix$ICD,icd9_elix$ICD)]
grep(grep_icd9_elix$ICD,icd9_elix$ICD)
antiICD9 <- anti_join(grep_icd9_elix,dxICD9,"ICD")
antiICD9
grep(antiICD9$ICD,grep_icd9_elix$ICD)
grep_icd9_elix$ICD[grepl(antiICD9$ICD,grep_icd9_elix$ICD)]
grep_icd9_elix$ICD[grepl(antiICD9$ICD[1:nrow(antiICD9)],grep_icd9_elix$ICD)]
antiICD9$ICD[1:nrow(antiICD9)]
grep_icd9_elix$ICD[grepl(antiICD9$ICD[i],grep_icd9_elix$ICD)]
for(i in 1:nrow(antiICD9)){
grep_icd9_elix$ICD[grepl(antiICD9$ICD[i],grep_icd9_elix$ICD)]
}
for(i in 1:nrow(antiICD9)){
grep_icd9_elix$ICD[grep(antiICD9$ICD[i],grep_icd9_elix$ICD)]
}
antiICD9$ICD[1]
antiICD9$ICD[2]
grep(antiICD9$ICD[1],grep_icd9_elix$ICD)
number <- c()
for(i in 1:nrow(antiICD9)){
number[i]grep_icd9_elix$ICD[grep(antiICD9$ICD[i],grep_icd9_elix$ICD)]
}
number <- c()
for(i in 1:nrow(antiICD9)){
number[i]<-grep_icd9_elix$ICD[grep(antiICD9$ICD[i],grep_icd9_elix$ICD)]
}
number
number <- c()
for(i in 1:nrow(antiICD9)){
number[i]<-grep(antiICD9$ICD[i],grep_icd9_elix$ICD)
}
number
grep_icd9_elix$ICD[number] <- c("","34200","4940","20930","28730")
ICDlist
for(range in 1:nrow(grep_icd9_elix)){
ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
grep_icd9_elix$ICD[number][1]
grep_icd9_elix$ICD[number][1] <- NULL
number
number[1]
grep_icd9_elix <- grep_icd9_elix$ICD[-number[1]]
icd9_elix$ICD <- sub("-0449$","",icd9_elix$ICD)
icd9_elix$ICD
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-"))),stringsAsFactors = F)
grep_icd9_elix$ICD <- str_trim(grep_icd9_elix$ICD,"both")
antiICD9 <- anti_join(grep_icd9_elix,dxICD9,"ICD")
antiICD9
number <- c()
for(i in 1:nrow(antiICD9)){
number[i]<-grep(antiICD9$ICD[i],grep_icd9_elix$ICD)
}
grep_icd9_elix$ICD[number] <- c("34200","4940","20930","28730")
grep_icd9_elix <- grep_icd9_elix$ICD[-number[1]]
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-"))),stringsAsFactors = F)
grep_icd9_elix$ICD <- str_trim(grep_icd9_elix$ICD,"both")
antiICD9 <- anti_join(grep_icd9_elix,dxICD9,"ICD")
number <- c()
for(i in 1:nrow(antiICD9)){
number[i]<-grep(antiICD9$ICD[i],grep_icd9_elix$ICD)
}
grep_icd9_elix$ICD[number] <- c("34200","4940","20930","28730")
unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-")))
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
icd9_elix$ICD <- sub("-3420$|-494$|-2093$|-2873$","-34200|-4940|-20930|-28730",icd9_elix$ICD)
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
icd9_elix$ICD <- sub("-0449$","",icd9_elix$ICD)
icd9_elix$ICD <- sub("-3420$","-34200",icd9_elix$ICD)
icd9_elix$ICD <- sub("-494$","-4940",icd9_elix$ICD)
icd9_elix$ICD <- sub("-2093$","-20930",icd9_elix$ICD)
icd9_elix$ICD <- sub("-2873$","-28730",icd9_elix$ICD)
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
icd9_elix$ICD <- sub("20925-34200|-4940|-20930|-28730","20925-34200",icd9_elix$ICD)
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
icd9_elix$ICD <- sub("20925-34200|-4940|-20930|-28730","20925-34200",icd9_elix$ICD)
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
icd9_elix <- icd9elix_TextToDf(textFile)
icd9_elix
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
icd9_elix$ICD <- sub("-0449$","",icd9_elix$ICD)
icd9_elix$ICD <- sub("-3420$","-34200",icd9_elix$ICD)
icd9_elix$ICD <- sub("-494$","-4940",icd9_elix$ICD)
icd9_elix$ICD <- sub("-2093$","-20930",icd9_elix$ICD)
icd9_elix$ICD <- sub("-2873$","-28730",icd9_elix$ICD)
icd9_elix$ICD <- sub("^2873","28730",icd9_elix$ICD)
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-"))),stringsAsFactors = F)
grep_icd9_elix$ICD <- str_trim(grep_icd9_elix$ICD,"both")
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
icd9_elix$ICD[grep("-",icd9_elix$ICD)]
grep_icd9_elix
anti_join(grep_icd9_elix,dxICD9,"ICD")
icd9_elix$ICD <- sub("^3420","34200",icd9_elix$ICD)
icd9_elix$ICD <- sub("^494","4940",icd9_elix$ICD)
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)],split = "-"))),stringsAsFactors = F)
grep_icd9_elix$ICD <- str_trim(grep_icd9_elix$ICD,"both")
anti_join(grep_icd9_elix,dxICD9,"ICD")
ICDlist <- c()
for(range in 1:nrow(grep_icd9_elix)){
ICDlist[length(ICDlist)+1] <- grep(paste("^",grep_icd9_elix$ICD[range],"$",sep=""),dxICD9$ICD)
}
ICDlist
test <- grep_icd9_elix
dxICD9$ICD[ICDlist[1]:(ICDlist[1]+(ICDlist[2]-ICDlist[1]))]
length(ICDlist)
test <- grep_icd9_elix
grepICD <- list()
for(ICD in 1:(length(ICDlist)-1)){
grepICD[[length(grepICD)+1]] <- dxICD9$ICD[ICDlist[ICD]:(ICDlist[ICD]+(ICDlist[ICD+1]-ICDlist[ICD]))]
Df <- data.frame(ICD = grepICD[[ICD]],
stringsAsFactors = F)
test <- rbind(test,Df)
}
View(test)
grepICD[[1]]<- dxICD9$ICD[ICDlist[1]:(ICDlist[1]+(ICDlist[1+1]-ICDlist[1]))]
grepICD
grepICD <- list()
grepICD[[1]]<- dxICD9$ICD[ICDlist[1]:(ICDlist[1]+(ICDlist[1+1]-ICDlist[1]))]
View(grepICD)
grepICD
grepICD[[1]]
Df <- data.frame(ICD = grepICD[[ICD]],
stringsAsFactors = F)
Df <- data.frame(ICD = grepICD[[1]],
stringsAsFactors = F)
test <- rbind(test,Df)
test <- grep_icd9_elix
test <- rbind(test,Df)
View(test)
test <- rbind(test,Df) %>% unique()
View(test)
test <- grep_icd9_elix
grepICD <- list()
for(ICD in 1:(length(ICDlist)-1)){
grepICD[[length(grepICD)+1]] <- dxICD9$ICD[ICDlist[ICD]:(ICDlist[ICD]+(ICDlist[ICD+1]-ICDlist[ICD]))]
Df <- data.frame(ICD = grepICD[[ICD]],
stringsAsFactors = F)
test <- rbind(test,Df) %>% unique()
}
View(test)
grep("-",icd9_elix$ICD)
length(grep("-",icd9_elix$ICD))
icd9_elix$ICD[grep("-",icd9_elix$ICD)[1]]
icd9_elix$Comorbidity_abbr[grep("-",icd9_elix$ICD)[1]]
for(i in 1:length(grep("-",icd9_elix$ICD))){
grep_icd9_elix <- data.frame(ICD = unlist(unname(strsplit(icd9_elix$ICD[grep("-",icd9_elix$ICD)[i]],split = "-"))),
Comorbidity_abbr = icd9_elix$Comorbidity_abbr[grep("-",icd9_elix$ICD)[i]],
Comorbidity = icd9_elix$Comorbidity[grep("-",icd9_elix$ICD)[i]],
stringsAsFactors = F)
}
